<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="颜貌岁岁改，波澜誓不起。">
<meta property="og:type" content="website">
<meta property="og:title" content="颜文字">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="颜文字">
<meta property="og:description" content="颜貌岁岁改，波澜誓不起。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="颜文字">
<meta name="twitter:description" content="颜貌岁岁改，波澜誓不起。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/"/>

  <title> 颜文字 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">颜文字</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'iRPRT9JgJfvxEsHZRgKm','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/nsdate/" itemprop="url">
                  NSDate
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/nsdate/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/nsdate/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1、【理解】NSDate的介绍和使用"><a href="#1、【理解】NSDate的介绍和使用" class="headerlink" title="1、【理解】NSDate的介绍和使用"></a>1、【理解】NSDate的介绍和使用</h4><ul>
<li>NSDate可以用来表示时间,可以进行一些常见的日期\时间处理。</li>
<li>一个NSDate对象就代表一个时间</li>
</ul>
<h4 id="2、格式化日期"><a href="#2、格式化日期" class="headerlink" title="2、格式化日期"></a>2、格式化日期</h4> <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSDateFormatter</span> *formatter = [[<span class="built_in">NSDateFormatter</span> alloc] init];</div><div class="line">formatter.dateFormat = <span class="string">@"yyyy-MM-dd HH:mm:ss"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 将NSString转换为NSDate</span></div><div class="line"><span class="built_in">NSDate</span> *date = [formatter dateFromString:<span class="string">@"2010-03-24 00:00:00"</span>];</div><div class="line"></div><div class="line"><span class="comment">// 将NSDate转换为NSString</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [formatter stringFromDate:date]);</div></pre></td></tr></table></figure>
<h4 id="3、计算日期"><a href="#3、计算日期" class="headerlink" title="3、计算日期"></a>3、计算日期</h4><ul>
<li>[NSDate date]返回的就是当前时间</li>
</ul>
<h4 id="4、日期时间对象"><a href="#4、日期时间对象" class="headerlink" title="4、日期时间对象"></a>4、日期时间对象</h4><ul>
<li>结合NSCalendar和NSDate能做更多的日期\时间处理</li>
<li><p>获得NSCalendar对象</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSCalendar</span> *calendar = [<span class="built_in">NSCalendar</span> currentCalendar];</div></pre></td></tr></table></figure>
</li>
<li><p>获得年月日</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSDateComponents</span> *)components:(<span class="built_in">NSCalendarUnit</span>)unitFlags fromDate:(<span class="built_in">NSDate</span> *)date;</div></pre></td></tr></table></figure>
</li>
<li><p>比较两个日期的差距</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSDateComponents</span> *)components:(<span class="built_in">NSCalendarUnit</span>)unitFlags fromDate:(<span class="built_in">NSDate</span> *)startingDate toDate:(<span class="built_in">NSDate</span> *)resultDate options:(<span class="built_in">NSCalendarOptions</span>)opts;</div></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/nsarrayandnsstring/" itemprop="url">
                  NSArray与NSString
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/nsarrayandnsstring/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/nsarrayandnsstring/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>将数组元素连接成字符串</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//NSArray的方法</span></div><div class="line"><span class="comment">//用 separator 作为拼接符将数组元素拼接成一个字符串</span></div><div class="line">- (<span class="built_in">NSString</span>)componentsJoinedByString:(<span class="built_in">NSString</span> *)separator;</div></pre></td></tr></table></figure>
<ul>
<li>将字符串分割成一个数组</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//NSString的方法</span></div><div class="line"><span class="comment">// 将字符串用separator作为分隔符切割成数组元素</span></div><div class="line">- (<span class="built_in">NSArray</span> *)componentsSeparatedByString:(<span class="built_in">NSString</span> *)separator;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/arcloop/" itemprop="url">
                  ARC循环引用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/arcloop/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/arcloop/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>1、ARC下循环引入问题</li>
<li>一个人拥有一只狗，一只狗拥有一个主人。<br><img src="/img/311.png" alt=""></li>
</ul>
<p><img src="/img/312.png" alt=""></p>
<ul>
<li><p>当增加d.owner = p;时形成循环引用。<br><img src="/img/313.png" alt=""><br>#####解决方法：一端用strong，一端用weak。</p>
</li>
<li><p>2、ARC下@property参数</p>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ARC中的<span class="keyword">@property</span></div><div class="line"><span class="keyword">strong</span> : 用于OC对象, 相当于MRC中的<span class="keyword">retain</span></div><div class="line"><span class="keyword">weak</span> : 用于OC对象, 相当于MRC中的<span class="keyword">assign</span></div><div class="line"><span class="keyword">assign</span> : 用于基本数据类型, 跟MRC中的<span class="keyword">assign</span>一样</div><div class="line"><span class="keyword">copy</span> : 一般用于<span class="built_in">NSString</span>, 跟MRC中的<span class="keyword">copy</span>一样</div><div class="line"></div><div class="line">在ARC情况下解决”循环<span class="keyword">retain</span>”的问题:<span class="keyword">@property</span>一边用<span class="keyword">strong</span>,一边用<span class="keyword">weak</span>。</div></pre></td></tr></table></figure>
<h3 id="ARC特点总结"><a href="#ARC特点总结" class="headerlink" title="ARC特点总结"></a>ARC特点总结</h3><ul>
<li>1）不允许调用release,retain,retainCount</li>
<li>2）允许重写dealloc,但是不允许调用[super dealloc]</li>
<li>3）@property的参数:<ul>
<li>strong:相当于原来的retain(适用于OC对象类型),成员变量是强指针</li>
<li>weak:相当于原来的assign,(适用于oc对象类型),成员变量是弱指针</li>
<li>assign:适用于非OC对象类型(基础类型)</li>
</ul>
</li>
</ul>
<h3 id="ARC使用注意事项"><a href="#ARC使用注意事项" class="headerlink" title="ARC使用注意事项"></a>ARC使用注意事项</h3><ul>
<li><p>1）ARC中,只要弱指针指向的对象不在了,就直接把弱指针做清空(赋值为nil)操作。</p>
</li>
<li><p>2）__weak Person *p=[[Personalloc]init];//不合理</p>
</li>
<li><p>对象一创建出来就被释放掉,对象释放掉后,ARC把指针设置为nil。</p>
</li>
<li><p>3）ARC中在property处不再使用retain,而是使用strong,在dealloc中不需要再 [super dealloc]。</p>
</li>
<li><p>@property(nonatomic,strong)Dog *dog;<br>// 意味着生成的成员变量_dog是一个强指针,相当于以前的retain。</p>
</li>
<li><p>4）如果换成是弱指针,则换成weak,不需要加<em> </em>。</p>
</li>
</ul>
<h2 id="ARC的兼容和转换"><a href="#ARC的兼容和转换" class="headerlink" title="ARC的兼容和转换"></a>ARC的兼容和转换</h2><ul>
<li><p>1、ARC模式下如何兼容非ARC的类</p>
<ul>
<li>让程序兼容ARC和非ARC部分。转变为非ARC -fno-objc-arc 转变为ARC的, -f-objc-arc 。<br><img src="/img//1.png" alt=""><br><img src="/img//11.png" alt=""><br><img src="/img//12.png" alt=""></li>
</ul>
</li>
<li><p>2、将MRC转换为ARC</p>
<ul>
<li>ARC也需要考虑循环引用问题：一端用strong，一端用weak。</li>
<li><code>提示：字符串是特殊的对象，但是不需要使用release手动释放，这种字符串对象默认就是autorelease，不需要额外管理内存。</code></li>
<li>如果一个项目是MRC的，那么我们可以把这个项目转换成ARC。<br><img src="/img//13.png" alt=""><br><img src="/img//2.png" alt=""><br><img src="/img//3.png" alt=""><br><img src="/img//4.png" alt=""><br><img src="/img//5.png" alt=""></li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/autorelease/" itemprop="url">
                  Autorelease
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/autorelease/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/autorelease/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>####1.自动释放池及autorelease介绍</p>
<ul>
<li><p>1.自动释放池</p>
<ul>
<li>(1)在iOS程序运行过程中,会创建无数个池子,这些池子都是以栈结构(先进后出)存在的。</li>
<li>(2)当一个对象调用autorelease时,会将这个对象放到位于栈顶的释放池中</li>
</ul>
</li>
<li><p>2.自动释放池的创建方式</p>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">(<span class="number">1</span>)iOS <span class="number">5.0</span>以前的创建方式</div><div class="line">    <span class="built_in">NSAutoreleasePool</span> *pool=[[<span class="built_in">NSAutoreleasePool</span> alloc] init];</div><div class="line">    <span class="comment">// 代码</span></div><div class="line">    [pool release];  <span class="comment">//[pool drain];用于mac</span></div><div class="line"></div><div class="line">(<span class="number">2</span>)iOS5<span class="number">.0</span>以后</div><div class="line"><span class="keyword">@autoreleasepool</span></div><div class="line">&#123;</div><div class="line">  <span class="comment">//开始代表创建自动释放池</span></div><div class="line">&#125; <span class="comment">//结束代表销毁自动释放池</span></div></pre></td></tr></table></figure>
<ul>
<li>3.autorelease<ul>
<li>是一种支持引用计数的内存管理方式</li>
<li>它可以暂时的保存某个对象(object),然后在内存池自己的排干(drain)的时候对其中的每个对象发送release消息。</li>
<li>注意,这里只是发送release消息,如果当时的引用计数(reference-counted)依然不为0,则该对象依然不会被释放。可以用该方法来保存某个对象,也要注意保存之后要释放该对象。</li>
</ul>
</li>
</ul>
<h4 id="2、【理解】为什么会有autorelease？"><a href="#2、【理解】为什么会有autorelease？" class="headerlink" title="2、【理解】为什么会有autorelease？"></a>2、【理解】为什么会有autorelease？</h4><ul>
<li><p>OC的内存管理机制中比较重要的一条规律是:谁申请,谁释放</p>
<ul>
<li>考虑这种情况,如果一个方法需要返回一个新建的对象,该对象何时释放?</li>
<li><p>方法内部是不会写release来释放对象的,因为这样做会将对象立即释放而返回一个空对象;</p>
</li>
<li><p>调用者也不会主动释放该对象的,因为调用者遵循“谁申请,谁释放”的原则。那么这个时候,就发生了内存泄露。</p>
</li>
</ul>
</li>
<li><p>不使用autorelease存在的问题</p>
<ul>
<li>针对这种情况,Objective-C的设计了autorelease,既能确保对象能正确释放,又能返回有效的 对象。</li>
</ul>
</li>
<li><p>使用autorelease的好处</p>
<ul>
<li>(1)不需要再关心对象释放的时间</li>
<li>(2)不需要再关心什么时候调用release</li>
</ul>
</li>
</ul>
<p>####3.autorelease基本用法</p>
<ul>
<li><p>基本用法</p>
<ul>
<li>(1)会将对象放到一个自动释放池中</li>
<li>(2)当自动释放池被销毁时,会对池子里的所有对象做一次release</li>
<li>(3)会返回对象本身</li>
<li><p>(4)调用完autorelease方法后,对象的计数器不受影响(销毁时影响)</p>
</li>
<li><p>在autorelease的模式下,下述方法是合理的,即可以正确返回结果,也不会造成内存泄露。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ClassA *Func1()</div><div class="line">&#123;</div><div class="line">  ClassA *obj = [[[ClassA alloc]init]autorelease];</div><div class="line">  <span class="keyword">return</span> obj;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="4、autorelease的原理？"><a href="#4、autorelease的原理？" class="headerlink" title="4、autorelease的原理？"></a>4、autorelease的原理？</h4><ul>
<li>autorelease实际上只是把对release的调用延迟了,对于每一个Autorelease,系统只是把该Object放入了当前的Autorelease pool中,当该pool被释放时,该pool中的所有Object会被调用Release。</li>
</ul>
<h4 id="5、autorelease什么时候被释放？"><a href="#5、autorelease什么时候被释放？" class="headerlink" title="5、autorelease什么时候被释放？"></a>5、autorelease什么时候被释放？</h4><ul>
<li><p>对于autorelease pool本身,会在如下两个条件发生时候被释放</p>
<ul>
<li>1)手动释放Autorelease pool</li>
<li><p>2)Runloop结束后自动释放</p>
</li>
<li><p>对于autorelease pool内部的对象</p>
</li>
<li>在引用计数的retainCount ==0的时候释放。release和autorelease pool的 drain都会触发retain–事件。</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/autoreleaseattention/" itemprop="url">
                  Autorelease注意事项
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/autoreleaseattention/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/autoreleaseattention/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1、autorelease使用注意"><a href="#1、autorelease使用注意" class="headerlink" title="1、autorelease使用注意"></a>1、autorelease使用注意</h2><p>#####1）并不是放到自动释放池中，都会自动加入到自动释放池</p>
<ul>
<li><p>1.1） 因为没有调用autorelease方法，所以对象没有加入到自动释放池.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> main() &#123;</div><div class="line">   <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">    Student *s = [[Student alloc] init];</div><div class="line">    [s release]; <span class="comment">// 正常释放</span></div><div class="line">   &#125;</div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>1.2）在自动释放池的外部发送autorelease不会被加入到自动释放池中。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> main()&#123;</div><div class="line">   <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line"></div><div class="line">   &#125;</div><div class="line">   <span class="comment">// 发送autorelease消息的对象，放到制动释放池外部</span></div><div class="line">   <span class="comment">// 此时无法被自动释放</span></div><div class="line">  Student *s = [[[Student alloc] init] autorelease];</div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>1.3）不管对象是在自动释放池里创建，还是自动释放池外创建，只要在自动释放池内写1个[s autorelease];s就会被放到自动释放池中，注意：autorelease是一个方法，且只有在自动释放池中使用才有效。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> main()&#123;</div><div class="line">     <span class="comment">// 不管在自动释放池内部还是外部创建</span></div><div class="line">     Student *s = [[Student alloc] init];</div><div class="line">     <span class="keyword">@autoreleasepool</span>&#123;</div><div class="line">         [s autorelease]; <span class="comment">// 此时s加入到释放池</span></div><div class="line">   &#125;</div><div class="line">   <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>2）自动释放池的嵌套使用</p>
<ul>
<li>自动释放池是栈结构。</li>
<li>栈：先进后出。后进先出，</li>
</ul>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">               <span class="comment">// 第一个池子，里面创建no的1学生</span></div><div class="line">                Student *s = [[[Student alloc] init] autorelease];</div><div class="line">                s.no = <span class="number">1</span>;</div><div class="line">        <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">                <span class="comment">// 第二个池子，里面创建no2的学生</span></div><div class="line">                   Student *s2 = [[[Student alloc] init] autorelease];</div><div class="line">                   s2.no = <span class="number">2</span>;</div><div class="line">            <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">                <span class="comment">// 第二个池子，里面创建no3的学生</span></div><div class="line">                        Student *s3 = [[[Student alloc] init] autorelease];</div><div class="line">                        s3.no = <span class="number">3</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>释放顺序：s3,s2,s1<ul>
<li>3）自动释放池中不适合放占用内存空间较大的对象</li>
<li>1&gt; 尽量避免对大内存使用该方法，对于这种延迟释放机制，尽量少用</li>
<li>2&gt; 不要把大量循环操作放到同1个自动释放池中，这样会造成内存峰值的上升。</li>
</ul>
</li>
</ul>
<p>####2)、autorelease错误用法</p>
<ul>
<li>1、连续调用多次autorelease。</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@autoreleasepool</span> &#123;</div><div class="line"></div><div class="line">    Student *s = [[[Student alloc] autorelease] autorelease];<span class="comment">// 调用了两次autorelease，对象过度释放。</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>2、对象创建在释放池外，但是在释放池内进行autorelease后，在释放池外，又进行了release。</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line"></div><div class="line">     Student *s = [[Student alloc] init];</div><div class="line"></div><div class="line">     <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line"></div><div class="line">        [s autorelease];<span class="comment">// 此时出池子后，对象可以被释放</span></div><div class="line"></div><div class="line">     &#125;</div><div class="line">        [s release];<span class="comment">// 对象被释放后再次调用释放，会出错。</span></div><div class="line"></div><div class="line"></div><div class="line">   <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>3、alloc之后调用了autorelease，之后又调用release。</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line"></div><div class="line">     <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line"></div><div class="line">        Student *s = [[[Student alloc] init] autorelease];</div><div class="line"></div><div class="line">     &#125;</div><div class="line">        [s release];</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>4、alloc之后调用release。</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line"></div><div class="line">     <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">   <span class="comment">// 因为release没有返回值，所以这样调用是错误的。</span></div><div class="line">        Student *s = [[[Student alloc] init] release];</div><div class="line">     &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>##2、autorelease的应用场景</p>
<h5 id="1、autorelease的应用场景"><a href="#1、autorelease的应用场景" class="headerlink" title="1、autorelease的应用场景"></a>1、autorelease的应用场景</h5><ul>
<li>经常用来在类方法中快速创建1个对象。</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 声明实现一个类方法</span></div><div class="line"> + (Student *)student</div><div class="line">&#123;</div><div class="line">    <span class="comment">// 在里面直接进行autorelease</span></div><div class="line">    <span class="keyword">return</span> [[[Student alloc] init] autorelease];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>应用：</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 在自动释放池中使用类方法创建对象</span></div><div class="line"><span class="keyword">@autoreleasepool</span>&#123;</div><div class="line"> <span class="comment">// 此时创建出来的对象不用关注释放问题。</span></div><div class="line">  Student *s = [Student student];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>错误写法：</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> main()&#123;</div><div class="line"><span class="comment">// 在自动释放池中使用类方法创建对象</span></div><div class="line"><span class="keyword">@autoreleasepool</span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="comment">// 写在自动释放池外部将无法释放对象。</span></div><div class="line"> Student *s = [Student student];</div><div class="line"> reutrn <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>#####2、完善快速创建对象的方法</p>
<ul>
<li><p>问题1：如果定1个GoodStudent，继承自Student,此时，还能使用类方法快速创建对象吗？</p>
<ul>
<li><p>解决方案：</p>
<ul>
<li>在类方法中使用id</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">   + (<span class="keyword">id</span>)student</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> [[[Student alloc] init] autorelease];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><code>此时，返回的对象仍旧是Student.所以，应该用self，替代Student.</code></p>
<ul>
<li>问题2：用其他对象类型，接受自定义对象类型。</li>
<li>如：<pre><code>NSString *s = [Student student];
NSLog(@&quot;%lu&quot;,s.length);
</code></pre><code>这段代码，编译时，不会报任何警告，但是运行时会直接崩溃。</code></li>
<li><p>改进办法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">//instancetype：可以动态判断返回的类型和接受的类型是否一致</span></div><div class="line">  + (<span class="keyword">instancetype</span>)student&#123;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> [[<span class="keyword">self</span> alloc] init];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>此时，编译器会警告</p>
<pre><code>NSString *s = [Student student];
NSLog(@&quot;%lu&quot;,s.length);
</code></pre></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/block/" itemprop="url">
                  Block
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/block/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/block/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1、什么是block？"><a href="#1、什么是block？" class="headerlink" title="1、什么是block？"></a>1、什么是block？</h3><ul>
<li>block是iOS中一种比较特殊的数据类型。</li>
<li>block是苹果官方特别推荐使用的数据类型，应用场景比较广泛。</li>
</ul>
<h3 id="2、使用场合？"><a href="#2、使用场合？" class="headerlink" title="2、使用场合？"></a>2、使用场合？</h3><pre><code>* 1）动画
* 2）多线程
* 3）集合遍历
* 4）网络请求回调
</code></pre><p>###3、block的作用</p>
<pre><code>* 用来保存一段代码，可以在恰当的时间再取出来调用.
</code></pre><h2 id="block的基本用法"><a href="#block的基本用法" class="headerlink" title="block的基本用法"></a>block的基本用法</h2><h3 id="1）简单的认识下block"><a href="#1）简单的认识下block" class="headerlink" title="1）简单的认识下block"></a>1）简单的认识下block</h3><ul>
<li><p>函数写法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">void</span> myBlock ()&#123;</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>block写法：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> (^myBlock)() =  ^&#123;</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">  <span class="built_in">NSLog</span>(@“******”);</div><div class="line">&#125;；</div><div class="line">myBlock();</div></pre></td></tr></table></figure>
</li>
<li><p>block格式：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> (^block名称)(参数列表) = ^(参数列表)&#123;</div><div class="line"><span class="comment">// 代码实现；</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="2）定义block遍历，存储一段代码，这段代码的功能是能打印任意行数"><a href="#2）定义block遍历，存储一段代码，这段代码的功能是能打印任意行数" class="headerlink" title="2）定义block遍历，存储一段代码，这段代码的功能是能打印任意行数"></a>2）定义block遍历，存储一段代码，这段代码的功能是能打印任意行数</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">void (^ myBlock)(int) = ^(int numberOfLines)&#123;</div><div class="line">  for(int i = 0; i &lt; numberOfLines ; i ++)&#123;</div><div class="line">     NSLog(@“******”);</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h5 id="3）定义block，计算两个整数的和"><a href="#3）定义block，计算两个整数的和" class="headerlink" title="3）定义block，计算两个整数的和."></a>3）定义block，计算两个整数的和.</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">int (^ sumBlock)(int,int) = ^(int num1, int num2)&#123;</div><div class="line">     return num1 + num2;</div><div class="line">&#125;;</div><div class="line">int c = sumBlock(10,20);</div><div class="line">NSLog(@“%d”,c);</div></pre></td></tr></table></figure>
<p>#####4）定义1个block，计算1个整数的平方<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">int (^squareBlock)(int);</div><div class="line">squareBlock = ^(int sum)&#123;</div><div class="line">   return sum * sum;</div><div class="line">&#125;;</div><div class="line">squareBlock(25);</div></pre></td></tr></table></figure></p>
<h2 id="block的typedef"><a href="#block的typedef" class="headerlink" title="block的typedef"></a>block的typedef</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> ( ^minusBlock)(<span class="keyword">int</span>,<span class="keyword">int</span>) = ^(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)&#123;</div><div class="line">  <span class="keyword">return</span> num1 - num2;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<ul>
<li><p>定义1个叫做:MyBlock的数据类型，它存储的代码必须返回int，，必须接受2个int类型参数</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span>(^MyBlock)(<span class="keyword">int</span>,<span class="keyword">int</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>重命名之后，可这样使用：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">MyBlock minusBlock = ^(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2)&#123;</div><div class="line">  <span class="keyword">return</span> num1 - num2;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>##block访问外部变量</p>
<ul>
<li><p>1）block访问外面变量。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> a = <span class="number">10</span>;</div><div class="line"><span class="keyword">void</span> (^block()) = ^&#123;</div><div class="line">  <span class="built_in">NSLog</span>(@“%d”,a);</div><div class="line">&#125;;</div><div class="line">block();</div></pre></td></tr></table></figure>
</li>
<li><p>2）block修改外部变量值</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">__block <span class="keyword">int</span> b = <span class="number">10</span>;</div><div class="line"><span class="keyword">void</span> (^block()) = ^&#123;</div><div class="line"> b = <span class="number">20</span>;</div><div class="line">  <span class="built_in">NSLog</span>(@“%d”,b);</div><div class="line">&#125;;</div><div class="line">block();</div></pre></td></tr></table></figure>
</li>
<li><p>3）block的快捷操作，名称写完整，直接敲回车.</p>
</li>
</ul>
<h2 id="block作为函数的返回值"><a href="#block作为函数的返回值" class="headerlink" title="block作为函数的返回值"></a>block作为函数的返回值</h2><ul>
<li>1、使用typedef定义一个新的类型</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//给block起一个别名</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span>(^newType)(<span class="keyword">int</span> num1,<span class="keyword">int</span> num2);</div></pre></td></tr></table></figure>
<ul>
<li>2、使用新类型作为函数的返回值</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//定义一个返回值是block类型的函数</span></div><div class="line">newType test()&#123;</div><div class="line"></div><div class="line"><span class="comment">//定义一个newType 类型的block变量</span></div><div class="line">newType work1=^(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</div><div class="line">&#123;</div><div class="line"><span class="keyword">return</span> x+y;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">return</span> work1;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>3）定义变量接收函数返回的值(block类型)</li>
<li>4）调用block</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//在main函数中调用返回值是newType类型的函数</span></div><div class="line"></div><div class="line"><span class="comment">// 定义block类型的变量n</span></div><div class="line">newType n = test();</div><div class="line"></div><div class="line"><span class="comment">// 调用block，输出结果</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"n = %d"</span>,n(<span class="number">10</span>,<span class="number">20</span>));</div></pre></td></tr></table></figure>
<h2 id="block结构的快速提示"><a href="#block结构的快速提示" class="headerlink" title="block结构的快速提示"></a>block结构的快速提示</h2><ul>
<li>输入：<code>inlineBlock</code></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/category/" itemprop="url">
                  Category
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/category/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/category/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 学习引入：</span></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> :<span class="title">NSObject</span> -(<span class="title">void</span>)<span class="title">run</span>;</span></div><div class="line">-(<span class="keyword">void</span>)eat;</div><div class="line">-(<span class="keyword">void</span>)study;</div><div class="line"><span class="keyword">@end</span> -(<span class="keyword">void</span>)playlol;</div></pre></td></tr></table></figure>
<h4 id="1、分类的概念："><a href="#1、分类的概念：" class="headerlink" title="1、分类的概念："></a>1、分类的概念：</h4><ul>
<li>Category：类别、类目、分类。</li>
</ul>
<h4 id="2、分类的作用"><a href="#2、分类的作用" class="headerlink" title="2、分类的作用"></a>2、分类的作用</h4><ul>
<li>1）将1个类中的不同方法分到多个不同的文件中存储，便于对类进行模块化设计和团队开发。</li>
<li>2）可以在不修改原来类的基础上，为这个类扩充一些方法。</li>
<li>3）注意：<ul>
<li>分类中只能增加“方法”，不能增加成员变量。</li>
<li>分类中可以访问原来类中的成员变量。</li>
</ul>
</li>
</ul>
<h4 id="3、使用分类的目的"><a href="#3、使用分类的目的" class="headerlink" title="3、使用分类的目的"></a>3、使用分类的目的</h4><ul>
<li>1）对现有类进行扩展:<ul>
<li>比如,你可以扩展Cocoa touch框架中的类,你在类别中增加的方法会被子类所继承,而且在运行 时跟其他的方法没有区别。</li>
</ul>
</li>
<li>2）作为子类的替代手段:<ul>
<li>不需要定义和使用一个子类,你可以通过类别直接向已有的类里增加方法。</li>
</ul>
</li>
<li>3）对类中的方法归类:<ul>
<li>利用category把一个庞大的类划分为小块来分别进行开发,从而更好的对类中的方法进行更新和维护。</li>
</ul>
</li>
</ul>
<h4 id="4、分类的使用流程"><a href="#4、分类的使用流程" class="headerlink" title="4、分类的使用流程"></a>4、分类的使用流程</h4><ul>
<li>声明分类–&gt;实现分类–&gt;使用分类</li>
<li>注意:分类的命名规则:类名+扩展方法,如“NSString+countNum”。 分类的接口声明与类的定义十分相似,但分类不继承父类,只需要带有一个括号,表明该分类的主要用途。</li>
</ul>
<h2 id="分类（Category）声明和实现"><a href="#分类（Category）声明和实现" class="headerlink" title="分类（Category）声明和实现"></a>分类（Category）声明和实现</h2><h4 id="1、声明和实现一个分类"><a href="#1、声明和实现一个分类" class="headerlink" title="1、声明和实现一个分类"></a>1、声明和实现一个分类</h4><ul>
<li><p>在.h文件中,声明分类:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> 类名 (分类名)</span></div><div class="line"><span class="comment">//方法;</span></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
</li>
<li><p>说明:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">声明分类格式</div><div class="line"><span class="number">1</span>）新添加的方法必须写在 <span class="class"><span class="keyword">@interface</span> 与 @<span class="title">end</span> 之间</span></div><div class="line"><span class="number">2</span>）ClassName 现有类的类名(要为哪个类扩展方法)。</div><div class="line"><span class="number">3</span>）CategoryName 待声明的分类名称</div><div class="line"><span class="number">4</span>）NewMethod 新添加的方法</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h5><ul>
<li><p>不允许在声明分类的时候定义变量</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span>(<span class="title">sport</span>)</span></div><div class="line">&#123;</div><div class="line">   <span class="keyword">int</span> _age; <span class="comment">// 报错</span></div><div class="line"> &#125;</div><div class="line">- (<span class="keyword">void</span>)run;</div><div class="line">- (<span class="keyword">void</span>)jump;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>在.m文件中(也可以在.h中实现),实现分类:</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ClassName</span>(<span class="title">CategoryName</span>) <span class="title">NewMethod</span></span></div><div class="line">&#123;</div><div class="line">......</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<ul>
<li><p>说明:</p>
<ul>
<li>实现类别格式<ul>
<li>1)新方法的实现必须写在@ implementation与@end之间</li>
<li>2)ClassName 现有类的类名</li>
<li>3)CategoryName 待声明的分类名称</li>
<li>4)NewMethod 新添加的方法的实现</li>
</ul>
</li>
</ul>
</li>
<li><p>也可以通过图形界面生成分类</p>
</li>
</ul>
<h6 id="2、调用分类中的方法"><a href="#2、调用分类中的方法" class="headerlink" title="2、调用分类中的方法"></a>2、调用分类中的方法</h6><ul>
<li>调用分类中的方法与一般方法调用，完全一样（需要导入头文件）</li>
</ul>
<h2 id="分类的注意事项"><a href="#分类的注意事项" class="headerlink" title="分类的注意事项"></a>分类的注意事项</h2><ol>
<li>分类只能增加方法, 不能增加成员变量</li>
<li>可以使用 @property, 此时只会生成setter/getter方法, 不会生成私有变量</li>
<li>如果分类的方法与原有类的方法重名, 那么优先调用分类中的方法, 原有类的方法被屏蔽</li>
</ol>
<h2 id="分类的编译顺序"><a href="#分类的编译顺序" class="headerlink" title="分类的编译顺序"></a>分类的编译顺序</h2><ol>
<li>当分类与主类中都有同一个方法时，优先调用分类中的方法。</li>
<li>当多个分类中都有同样的一个方法时，优先调用最后一个参与编译的分类中的方法。</li>
</ol>
<h2 id="所谓的非正式协议就是分类-即凡是NSObject或其子类Foundation框架中的类-增加的分类-都是非正式协议。"><a href="#所谓的非正式协议就是分类-即凡是NSObject或其子类Foundation框架中的类-增加的分类-都是非正式协议。" class="headerlink" title="所谓的非正式协议就是分类,即凡是NSObject或其子类Foundation框架中的类,增加的分类,都是非正式协议。"></a><code>所谓的非正式协议就是分类,即凡是NSObject或其子类Foundation框架中的类,增加的分类,都是非正式协议。</code></h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/classandobject/" itemprop="url">
                  类与对象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/classandobject/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/classandobject/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>对象:</strong>某一个具体的存在</p>
<p><strong>类:</strong>具有相似内部状态和运动规律的实体的集合. 具有相同属性和行为事物的统称</p>
<p>##类的构成</p>
<ol>
<li>类的名称:类名</li>
<li>类的属性:一组包含数据的属性</li>
<li>类的方法:允许对属性包含的数据进行操作的方法</li>
</ol>
<p>##创建一个对象<br>[NSObject new] 在内存的干的三件事</p>
<ol>
<li>在堆中开辟一段存储空间</li>
<li>初始化成员变量(类声明大括号中的属性叫成员变量, 也叫实例变量)</li>
<li>返回开辟空间的首地址</li>
</ol>
<h2 id="pragma-mark的使用"><a href="#pragma-mark的使用" class="headerlink" title="#pragma mark的使用"></a>#pragma mark的使用</h2><ol>
<li><h6 id="pragma-mark"><a href="#pragma-mark" class="headerlink" title="#pragma mark -"></a>#pragma mark -</h6></li>
<li><h6 id="pragma-mark-名称"><a href="#pragma-mark-名称" class="headerlink" title="#pragma mark 名称"></a>#pragma mark 名称</h6></li>
<li><h6 id="如果你的标志没有出现在弹出菜单中-比如没有分割线出现-请再Xcode菜-单”Preferences…”中的-“Code-Sense”-选项取消选中“Sort-list-alphabetically”即可"><a href="#如果你的标志没有出现在弹出菜单中-比如没有分割线出现-请再Xcode菜-单”Preferences…”中的-“Code-Sense”-选项取消选中“Sort-list-alphabetically”即可" class="headerlink" title="如果你的标志没有出现在弹出菜单中,比如没有分割线出现,请再Xcode菜 单”Preferences…”中的 “Code Sense” 选项取消选中“Sort list alphabetically”即可"></a>如果你的标志没有出现在弹出菜单中,比如没有分割线出现,请再Xcode菜 单”Preferences…”中的 “Code Sense” 选项取消选中“Sort list alphabetically”即可</h6></li>
</ol>
<h3 id="类方法"><a href="#类方法" class="headerlink" title="类方法"></a>类方法</h3><pre><code>类方法中可以直接调用类方法
类方法中不可以直接调用对象方法
类方法中不能访问成员变量
</code></pre><h3 id="self"><a href="#self" class="headerlink" title="self"></a>self</h3><p><code>不能在对象方法或类方法中利用self调用当前self所在的方法</code></p>
<pre><code>如果self在对象方法中,那么self就代表调用当前对象方法的那个对象
如果self在类方法中,那么self就代表调用当前类方法的那个类;
总结:
我们只有关注self在类方法中,还是在对象方法中,在类方法中,代表当前类,在对象方法中代表&quot;当前调用该方法的对象&quot;
</code></pre><h3 id="super"><a href="#super" class="headerlink" title="super"></a>super</h3><ul>
<li><p>概念:</p>
<p>  super是编译器的指令符号,只是告诉编译器在执行的时候,去调用谁的方法</p>
</li>
<li><p>作用:</p>
<p>  1.直接调用父类的某个方法</p>
<p>  2.super在对象方法中,那么会调用父类的对象方法</p>
<p>  3.super在类方法中,那么会调用父类的类方法</p>
</li>
</ul>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><ul>
<li><p>继承:</p>
<p>  A类继承B类,那么A累就用于B类所有的属性及方法</p>
</li>
<li><p>优点:</p>
<p>  1.提高代码的复用性</p>
<p>  2.可以让类与类产生关系,正是因为继承让我们的类与类之间产生关系,所有才有了多态</p>
</li>
<li><p>注意:</p>
<p>  千万不要以为继承可以提高代码的复用性,但凡发现多个类当中有复用的代码就抽取一个父类</p>
<p>  只有满足一定的条件我们才能够使用继承</p>
<p>  条件: XXX 是 XXX 或者 某某 is a 某某</p>
<pre><code>Iphone 继承 Phone  Iphone is a Phone
</code></pre></li>
</ul>
<p>缺点:</p>
<pre><code>耦合性太强(依赖性太强)
</code></pre><h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><ul>
<li><p>多态:</p>
<p>  事物多种表现形态</p>
</li>
<li><p>表现:</p>
<p>  父类的指针指向子类的对象</p>
</li>
<li><p>优点:</p>
<p>  提高代码的扩展性</p>
</li>
<li><p>注意点:</p>
<p>  如果父类指针指向子类对象,如果需要调用子类特有的方法,必须强制类型转换才能调用</p>
</li>
</ul>
<h3 id="实例变量修饰符"><a href="#实例变量修饰符" class="headerlink" title="实例变量修饰符"></a>实例变量修饰符</h3><p> @public</p>
<blockquote>
<p>可以在其他类中访问被 @public 修饰的成员变量</p>
<p>也可以在本类中访问被 @public 修饰的成员变量</p>
<p>可以在子类类中访问父类中被 @public 修饰的成员变量</p>
</blockquote>
<p> @private</p>
<blockquote>
<p>不可以在其他类中访问被 @private 修饰的成员变量</p>
<p>可以在本类中访问被 @private 修饰的成员变量</p>
<p>不可以在子类中访问父类中被 @private 修饰的成员变量</p>
</blockquote>
<p> @protected</p>
<blockquote>
<p>不可以在其他类中访问被 @protected 修饰的成员变量</p>
<p>可以在本类中访问被 @protected 修饰的成员变量</p>
<p>可以在子类中访问父类中被 @protected 修饰的成员变量</p>
</blockquote>
<p> 注意:默认情况下所有实例变量都是 @protected</p>
<p> @package</p>
<blockquote>
<p>介于 @public 和 @private 之间</p>
<p>如果在其他包中访问,那么是 @private</p>
<p>如果是在当前代码所在的包中访问就是 @public</p>
</blockquote>
<p> 实例变量修饰符的作用域:从出现的位置开始,一直到下一个修饰符出现</p>
<h3 id="id-instancetype"><a href="#id-instancetype" class="headerlink" title="id - instancetype"></a>id - instancetype</h3><ol>
<li>instancetype == id == 万能指针 == 指向一个对象</li>
<li>instancetype在编译的时候可以判断对象的真实类型</li>
<li>id在编译的时候不能判断对象的真实类型</li>
<li>id 可以用来定义变量,可以作为返回值,可以作为形参</li>
<li>instancetype 只能用来作为返回值</li>
</ol>
<p><code>注意:自定义构造方法,返回值尽量使用instancetype,不要使用id</code></p>
<h3 id="load-initialize"><a href="#load-initialize" class="headerlink" title="load - initialize"></a>load - initialize</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//load 一启动就调用,仅一次</span></div><div class="line"><span class="comment">//1.只有程序启动,就会将所有类的代码加载到内存中,放到代码区</span></div><div class="line"><span class="comment">//load方法会在当前类被加载到内存的时候调用,有且仅会调用一次</span></div><div class="line"><span class="comment">//如果有继承关系,先调用父类的load方法,在调用子类的load方法</span></div><div class="line">+ (<span class="keyword">void</span>)load</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Person类被加载到内存了"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//initialize 一使用就调用,仅一次</span></div><div class="line"><span class="comment">//2.当当前类第一次被使用的时候就会被调用(创建类对象的时候)</span></div><div class="line"><span class="comment">//initialize 方法在整个程序的运行过程中只会被被调用一次  因为类对象只有一个</span></div><div class="line"><span class="comment">//initialize 用于对某个类进行 一次性 的初始化化</span></div><div class="line"><span class="comment">//如果有继承关系,先调用父类的initialize方法,在调用子类的initialize 方法</span></div><div class="line">+ (<span class="keyword">void</span>)initialize</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Person类的initialize 方法"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="SEL-类型"><a href="#SEL-类型" class="headerlink" title="SEL 类型"></a>SEL 类型</h3><ul>
<li>是否响应该方法</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)respondsToSelector:(SEL)aSelector;</div></pre></td></tr></table></figure>
<ul>
<li>调用该方法</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//performSelector 最多只能传递两个参数</span></div><div class="line">- (<span class="keyword">id</span>)performSelector:(SEL)aSelector;</div><div class="line">- (<span class="keyword">id</span>)performSelector:(SEL)aSelector withObject:(<span class="keyword">id</span>)object;</div><div class="line">- (<span class="keyword">id</span>)performSelector:(SEL)aSelector withObject:(<span class="keyword">id</span>)object1 withObject:(<span class="keyword">id</span>)object2;</div></pre></td></tr></table></figure>
<h3 id="野指针-空指针"><a href="#野指针-空指针" class="headerlink" title="野指针 - 空指针"></a>野指针 - 空指针</h3><ul>
<li><p>野指针:</p>
<p>  当一个指针指向了一个”僵尸对象”我们就称这个指针为 野指针</p>
<p>  只有给一个野指针发送消息,就会报错</p>
<p>  <em>*</em> -[Person release]: message sent to deallocated instance 0x100305ef0</p>
<p>  发送了一个消息给了一个已经释放的实例对象</p>
</li>
<li><p>空指针: nil 0 NULL</p>
<p>  为了避免给野指针发送消息会报错,一般情况下,当一个对象被释放后我们会将这个对象的指针设置为空指针</p>
<p>  在OC中给空指针发送消息不会报错</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/copy/" itemprop="url">
                  Copy
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/copy/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/copy/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1、copy的概念"><a href="#1、copy的概念" class="headerlink" title="1、copy的概念"></a>1、copy的概念</h4><ul>
<li>Copy的字面意思是“复制”、“拷贝”，是一个产生副本的过程。</li>
<li><p><strong>常见的复制有：文件复制</strong></p>
</li>
<li><p>作用：利用一个源文件产生一个副本文件</p>
</li>
<li>特点：<ul>
<li>修改源文件的内容，不会影响副本文件</li>
<li>修改副本文件的内容，不会影响源文件</li>
</ul>
</li>
</ul>
<ul>
<li><strong> OC中的copy</strong><ul>
<li>作用：利用一个源对象产生一个副本对象</li>
<li>特点：<ul>
<li>修改源对象的属性和行为，不会影响副本对象</li>
<li>修改副本对象的属性和行为，不会影响源对象</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="2、copy快速入门"><a href="#2、copy快速入门" class="headerlink" title="2、copy快速入门"></a>2、copy快速入门</h4><ul>
<li>如何使用copy功能<ul>
<li>一个对象可以调用copy或mutableCopy方法来创建一个副本对象</li>
<li>copy : 创建的是不可变副本(如NSString、NSArray、NSDictionary)</li>
<li>mutableCopy :创建的是可变副本(如NSMutableString、NSMutableArray、NSMutableDictionary)</li>
</ul>
</li>
</ul>
<ul>
<li><p>使用copy功能的前提</p>
<ul>
<li>copy : 需要遵守NSCopying协议，实现copyWithZone:方法</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">@protocol</span> <span class="title">NSCopying</span></span></div><div class="line"> - (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<ul>
<li>mutableCopy :需要遵守NSMutableCopying协议，实现mutableCopyWithZone:方法</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">NSMutableCopying</span></span></div><div class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="built_in">NSZone</span> *)zone;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/copyaction/" itemprop="url">
                  为自定义的类实现copy操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T11:39:06+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Objective-C/" itemprop="url" rel="index">
                    <span itemprop="name">Objective-C</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/07/copyaction/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/07/copyaction/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#####自定义对象copy步骤</p>
<ul>
<li>新建Person类</li>
<li><p>为Person类实现copy操作</p>
<ul>
<li>1.让Person类遵守NSCopying协议</li>
<li>2.实现 copyWithZone:方法,在该方法中返回一个对象的副本即可。</li>
<li><ol>
<li>在copyWithZone方法中,创建一个新的对象,并设置该对象的数据与现有对象一致, 并返回该对象.</li>
</ol>
</li>
<li><p>创建Person对象, 调用copy方法, 查看地址。</p>
</li>
</ul>
</li>
<li><p>细节介绍:</p>
<ul>
<li>1、 调用copy其实就是调用copyWithZone方法,所以要实现copyWithZone方法。(查看NSObject协议中的copy方法的介绍)</li>
<li>2、 copyWithZone方法返回值类型是id类型,需要返回一个对象的副本。</li>
<li><p>3、 关于copyWithZone的参数zone问题:</p>
<ul>
<li><p>zone: 表示空间,分配对象是需要内存空间的,如果指定了zone,就可以指定新建对象对应的内存空间。但是:zone是一个非常古老的技术,为了避免在堆中出现内存碎片而使用的。在今天的开发中,zone几乎可以忽略</p>
</li>
<li><p>查看NSCopying协议中的allocWithZone:方法介绍(zone参数可以被忽略,是历史 原因)</p>
</li>
</ul>
</li>
<li><p>4、如果对象没有 可变/不可变 的版本区别,只要实现 copyWithZone 方法即可.</p>
</li>
<li><p>5、copyWithZone:方法的具体实现:</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone&#123;</div><div class="line"><span class="comment">//创建对象</span></div><div class="line">Person *p1 = [[Person alloc] init]; <span class="comment">//用当前对象值给新对象的实例变量赋值 p1.age = self.age;</span></div><div class="line"><span class="comment">//返回新对象</span></div><div class="line"><span class="keyword">return</span> p1;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>为Person类实现mutableCopy操作<ul>
<li>1.遵守NSMutableCopying协议</li>
<li>2.实现协议对你的方法</li>
</ul>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="built_in">NSZone</span> *)zone&#123;</div><div class="line"><span class="comment">//创建对象</span></div><div class="line">Person *p1 = [[Person alloc] init]; <span class="comment">//用当前对象值给新对象的实例变量赋值 p1.age = self.age;</span></div><div class="line"><span class="comment">//返回新对象</span></div><div class="line"><span class="keyword">return</span> p1;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=697890588,3646918970&fm=116&gp=0.jpg"
               alt="颜文字" />
          <p class="site-author-name" itemprop="name">颜文字</p>
          <p class="site-description motion-element" itemprop="description">颜貌岁岁改，波澜誓不起。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">97</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">59</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yanhuangzisuen" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.weibo.com/yanyan767006743" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">颜文字</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"yancode"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
